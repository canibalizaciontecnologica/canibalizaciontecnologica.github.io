import{r as b,j as D}from"./react-Wu2nlj90.js";import{W as it,R as st,O as at,P as ct,S as lt,a as de,V as ft,b as ut,B as pt,L as dt,c as Ne,N as vt,A as mt,d as Oe,C as ht,e as gt,U as bt,f as oe,g as yt,h as jt,i as wt,T as Ct,j as Et,H as Pt,k as Te,D as St,F as Mt}from"./three-W4STMiRo.js";import{j as xt}from"./react-use-measure-DLYm2C2s.js";import{c as Rt,x as Ot,i as Tt,m as It}from"./its-fine-DpVWcAnZ.js";import{c as ie,R as _t}from"./react-reconciler-DZnrQAoa.js";import{s as Ie}from"./scheduler-DpnzcFAA.js";import"./react-dom-lQi1xorK.js";import{_ as Be}from"./@babel-CF3RwP-h.js";import{O as kt}from"./three-stdlib-JhZDiiQY.js";import{c as At}from"./zustand-Bif17rXD.js";import{s as Ft,p as Lt,c as Dt}from"./suspend-react-BKIKQNXN.js";function qe(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const Ue=e=>e&&e.isOrthographicCamera,Ht=e=>e&&e.hasOwnProperty("current"),zt=e=>e!=null&&(typeof e=="string"||typeof e=="number"||e.isColor),Q=((e,t)=>typeof window!="undefined"&&(((e=window.document)==null?void 0:e.createElement)||((t=window.navigator)==null?void 0:t.product)==="ReactNative"))()?b.useLayoutEffect:b.useEffect;function Ve(e){const t=b.useRef(e);return Q(()=>void(t.current=e),[e]),t}function Nt(){const e=Rt(),t=Ot();return b.useMemo(()=>({children:n})=>{const o=!!Tt(e,!0,s=>s.type===b.StrictMode)?b.StrictMode:b.Fragment;return D.jsx(o,{children:D.jsx(t,{children:n})})},[e,t])}function Bt({set:e}){return Q(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const qt=(e=>(e=class extends b.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function Xe(e){var t;const n=typeof window!="undefined"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function G(e){var t;return(t=e.__r3f)==null?void 0:t.root.getState()}const R={obj:e=>e===Object(e)&&!R.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,nul:e=>e===null,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(R.str(e)||R.num(e)||R.boo(e))return e===t;const s=R.obj(e);if(s&&r==="reference")return e===t;const u=R.arr(e);if(u&&n==="reference")return e===t;if((u||s)&&e===t)return!0;let l;for(l in e)if(!(l in t))return!1;if(s&&n==="shallow"&&r==="shallow"){for(l in o?t:e)if(!R.equ(e[l],t[l],{strict:o,objects:"reference"}))return!1}else for(l in o?t:e)if(e[l]!==t[l])return!1;if(R.und(l)){if(u&&e.length===0&&t.length===0||s&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Ut(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material),n.isMesh&&!t.meshes[n.name]&&(t.meshes[n.name]=n)}),t}function Vt(e){e.type!=="Scene"&&(e.dispose==null||e.dispose());for(const t in e){const n=e[t];(n==null?void 0:n.type)!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const Ge=["children","key","ref"];function Xt(e){const t={};for(const n in e)Ge.includes(n)||(t[n]=e[n]);return t}function ae(e,t,n,r){const o=e;let s=o==null?void 0:o.__r3f;return s||(s={root:t,type:n,parent:null,children:[],props:Xt(r),object:o,eventCount:0,handlers:{},isHidden:!1},o&&(o.__r3f=s)),s}function K(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const o of t.split("-")){var r;t=o,e=n,n=(r=n)==null?void 0:r[t]}return{root:e,key:t,target:n}}const _e=/-\d+$/;function ce(e,t){if(R.str(t.props.attach)){if(_e.test(t.props.attach)){const o=t.props.attach.replace(_e,""),{root:s,key:u}=K(e.object,o);Array.isArray(s[u])||(s[u]=[])}const{root:n,key:r}=K(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else R.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function le(e,t){if(R.str(t.props.attach)){const{root:n,key:r}=K(e.object,t.props.attach),o=t.previousAttach;o===void 0?delete n[r]:n[r]=o}else t.previousAttach==null||t.previousAttach(e.object,t.object);delete t.previousAttach}const we=[...Ge,"args","dispose","attach","object","onUpdate","dispose"],ke=new Map;function Gt(e){let t=ke.get(e.constructor);try{t||(t=new e.constructor,ke.set(e.constructor,t))}catch{}return t}function Wt(e,t){const n={};for(const r in t)if(!we.includes(r)&&!R.equ(t[r],e.props[r])){n[r]=t[r];for(const o in t)o.startsWith(`${r}-`)&&(n[o]=t[o])}for(const r in e.props){if(we.includes(r)||t.hasOwnProperty(r))continue;const{root:o,key:s}=K(e.object,r);if(o.constructor&&o.constructor.length===0){const u=Gt(o);R.und(u)||(n[s]=u[s])}else n[s]=0}return n}const Yt=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Zt=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function B(e,t){var n;const r=e.__r3f,o=r&&qe(r).getState(),s=r==null?void 0:r.eventCount;for(const l in t){let i=t[l];if(we.includes(l))continue;if(r&&Zt.test(l)){typeof i=="function"?r.handlers[l]=i:delete r.handlers[l],r.eventCount=Object.keys(r.handlers).length;continue}if(i===void 0)continue;let{root:d,key:a,target:f}=K(e,l);if(f instanceof Oe&&i instanceof Oe)f.mask=i.mask;else if(f instanceof ht&&zt(i))f.set(i);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof f.copy=="function"&&i!=null&&i.constructor&&f.constructor===i.constructor)f.copy(i);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&Array.isArray(i))typeof f.fromArray=="function"?f.fromArray(i):f.set(...i);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof i=="number")typeof f.setScalar=="function"?f.setScalar(i):f.set(i);else{var u;d[a]=i,o&&!o.linear&&Yt.includes(a)&&(u=d[a])!=null&&u.isTexture&&d[a].format===gt&&d[a].type===bt&&(d[a].colorSpace=Ne)}}if(r!=null&&r.parent&&o!=null&&o.internal&&(n=r.object)!=null&&n.isObject3D&&s!==r.eventCount){const l=r.object,i=o.internal.interaction.indexOf(l);i>-1&&o.internal.interaction.splice(i,1),r.eventCount&&l.raycast!==null&&o.internal.interaction.push(l)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&$(r),e}function $(e){var t;if(!e.parent)return;e.props.onUpdate==null||e.props.onUpdate(e.object);const n=(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function $t(e,t){e.manual||(Ue(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const F=e=>e==null?void 0:e.isObject3D;function ne(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function We(e,t,n,r){const o=n.get(t);o&&(n.delete(t),n.size===0&&(e.delete(r),o.target.releasePointerCapture(r)))}function Jt(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,o)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(o)}),n.capturedMap.forEach((r,o)=>{We(n.capturedMap,t,r,o)})}function Kt(e){function t(i){const{internal:d}=e.getState(),a=i.offsetX-d.initialClick[0],f=i.offsetY-d.initialClick[1];return Math.round(Math.sqrt(a*a+f*f))}function n(i){return i.filter(d=>["Move","Over","Enter","Out","Leave"].some(a=>{var f;return(f=d.__r3f)==null?void 0:f.handlers["onPointer"+a]}))}function r(i,d){const a=e.getState(),f=new Set,v=[],h=d?d(a.internal.interaction):a.internal.interaction;for(let p=0;p<h.length;p++){const c=G(h[p]);c&&(c.raycaster.camera=void 0)}a.previousRoot||a.events.compute==null||a.events.compute(i,a);function S(p){const c=G(p);if(!c||!c.events.enabled||c.raycaster.camera===null)return[];if(c.raycaster.camera===void 0){var j;c.events.compute==null||c.events.compute(i,c,(j=c.previousRoot)==null?void 0:j.getState()),c.raycaster.camera===void 0&&(c.raycaster.camera=null)}return c.raycaster.camera?c.raycaster.intersectObject(p,!0):[]}let M=h.flatMap(S).sort((p,c)=>{const j=G(p.object),E=G(c.object);return!j||!E?p.distance-c.distance:E.events.priority-j.events.priority||p.distance-c.distance}).filter(p=>{const c=ne(p);return f.has(c)?!1:(f.add(c),!0)});a.events.filter&&(M=a.events.filter(M,a));for(const p of M){let c=p.object;for(;c;){var y;(y=c.__r3f)!=null&&y.eventCount&&v.push({...p,eventObject:c}),c=c.parent}}if("pointerId"in i&&a.internal.capturedMap.has(i.pointerId))for(let p of a.internal.capturedMap.get(i.pointerId).values())f.has(ne(p.intersection))||v.push(p.intersection);return v}function o(i,d,a,f){if(i.length){const v={stopped:!1};for(const h of i){let S=G(h.object);if(S||h.object.traverseAncestors(M=>{const y=G(M);if(y)return S=y,!1}),S){const{raycaster:M,pointer:y,camera:p,internal:c}=S,j=new oe(y.x,y.y,0).unproject(p),E=C=>{var x,O;return(x=(O=c.capturedMap.get(C))==null?void 0:O.has(h.eventObject))!=null?x:!1},g=C=>{const x={intersection:h,target:d.target};c.capturedMap.has(C)?c.capturedMap.get(C).set(h.eventObject,x):c.capturedMap.set(C,new Map([[h.eventObject,x]])),d.target.setPointerCapture(C)},m=C=>{const x=c.capturedMap.get(C);x&&We(c.capturedMap,h.eventObject,x,C)};let T={};for(let C in d){let x=d[C];typeof x!="function"&&(T[C]=x)}let I={...h,...T,pointer:y,intersections:i,stopped:v.stopped,delta:a,unprojectedPoint:j,ray:M.ray,camera:p,stopPropagation(){const C="pointerId"in d&&c.capturedMap.get(d.pointerId);if((!C||C.has(h.eventObject))&&(I.stopped=v.stopped=!0,c.hovered.size&&Array.from(c.hovered.values()).find(x=>x.eventObject===h.eventObject))){const x=i.slice(0,i.indexOf(h));s([...x,h])}},target:{hasPointerCapture:E,setPointerCapture:g,releasePointerCapture:m},currentTarget:{hasPointerCapture:E,setPointerCapture:g,releasePointerCapture:m},nativeEvent:d};if(f(I),v.stopped===!0)break}}}return i}function s(i){const{internal:d}=e.getState();for(const a of d.hovered.values())if(!i.length||!i.find(f=>f.object===a.object&&f.index===a.index&&f.instanceId===a.instanceId)){const v=a.eventObject.__r3f;if(d.hovered.delete(ne(a)),v!=null&&v.eventCount){const h=v.handlers,S={...a,intersections:i};h.onPointerOut==null||h.onPointerOut(S),h.onPointerLeave==null||h.onPointerLeave(S)}}}function u(i,d){for(let a=0;a<d.length;a++){const f=d[a].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(i)}}function l(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return d=>{const{internal:a}=e.getState();"pointerId"in d&&a.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{a.capturedMap.has(d.pointerId)&&(a.capturedMap.delete(d.pointerId),s([]))})}}return function(a){const{onPointerMissed:f,internal:v}=e.getState();v.lastEvent.current=a;const h=i==="onPointerMove",S=i==="onClick"||i==="onContextMenu"||i==="onDoubleClick",y=r(a,h?n:void 0),p=S?t(a):0;i==="onPointerDown"&&(v.initialClick=[a.offsetX,a.offsetY],v.initialHits=y.map(j=>j.eventObject)),S&&!y.length&&p<=2&&(u(a,v.interaction),f&&f(a)),h&&s(y);function c(j){const E=j.eventObject,g=E.__r3f;if(!(g!=null&&g.eventCount))return;const m=g.handlers;if(h){if(m.onPointerOver||m.onPointerEnter||m.onPointerOut||m.onPointerLeave){const T=ne(j),I=v.hovered.get(T);I?I.stopped&&j.stopPropagation():(v.hovered.set(T,j),m.onPointerOver==null||m.onPointerOver(j),m.onPointerEnter==null||m.onPointerEnter(j))}m.onPointerMove==null||m.onPointerMove(j)}else{const T=m[i];T?(!S||v.initialHits.includes(E))&&(u(a,v.interaction.filter(I=>!v.initialHits.includes(I))),T(j)):S&&v.initialHits.includes(E)&&u(a,v.interaction.filter(I=>!v.initialHits.includes(I)))}}o(y,a,p,c)}}return{handlePointer:l}}const Ae=e=>!!(e!=null&&e.render),Ye=b.createContext(null),Qt=(e,t)=>{const n=At((l,i)=>{const d=new oe,a=new oe,f=new oe;function v(p=i().camera,c=a,j=i().size){const{width:E,height:g,top:m,left:T}=j,I=E/g;c.isVector3?f.copy(c):f.set(...c);const C=p.getWorldPosition(d).distanceTo(f);if(Ue(p))return{width:E/p.zoom,height:g/p.zoom,top:m,left:T,factor:1,distance:C,aspect:I};{const x=p.fov*Math.PI/180,O=2*Math.tan(x/2)*C,q=O*(E/g);return{width:q,height:O,top:m,left:T,factor:E/q,distance:C,aspect:I}}}let h;const S=p=>l(c=>({performance:{...c.performance,current:p}})),M=new yt;return{set:l,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(p=1)=>e(i(),p),advance:(p,c)=>t(p,c,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new jt,pointer:M,mouse:M,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const p=i();h&&clearTimeout(h),p.performance.current!==p.performance.min&&S(p.performance.min),h=setTimeout(()=>S(i().performance.max),p.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:p=>l(c=>({...c,events:{...c.events,...p}})),setSize:(p,c,j=0,E=0)=>{const g=i().camera,m={width:p,height:c,top:j,left:E};l(T=>({size:m,viewport:{...T.viewport,...v(g,a,m)}}))},setDpr:p=>l(c=>{const j=Xe(p);return{viewport:{...c.viewport,dpr:j,initialDpr:c.viewport.initialDpr||j}}}),setFrameloop:(p="always")=>{const c=i().clock;c.stop(),c.elapsedTime=0,p!=="never"&&(c.start(),c.elapsedTime=0),l(()=>({frameloop:p}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:b.createRef(),active:!1,frames:0,priority:0,subscribe:(p,c,j)=>{const E=i().internal;return E.priority=E.priority+(c>0?1:0),E.subscribers.push({ref:p,priority:c,store:j}),E.subscribers=E.subscribers.sort((g,m)=>g.priority-m.priority),()=>{const g=i().internal;g!=null&&g.subscribers&&(g.priority=g.priority-(c>0?1:0),g.subscribers=g.subscribers.filter(m=>m.ref!==p))}}}}}),r=n.getState();let o=r.size,s=r.viewport.dpr,u=r.camera;return n.subscribe(()=>{const{camera:l,size:i,viewport:d,gl:a,set:f}=n.getState();if(i.width!==o.width||i.height!==o.height||d.dpr!==s){o=i,s=d.dpr,$t(l,i),d.dpr>0&&a.setPixelRatio(d.dpr);const v=typeof HTMLCanvasElement!="undefined"&&a.domElement instanceof HTMLCanvasElement;a.setSize(i.width,i.height,v)}l!==u&&(u=l,f(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(l)}})))}),n.subscribe(l=>e(l)),n};function Ze(){const e=b.useContext(Ye);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function L(e=n=>n,t){return Ze()(e,t)}function $e(e,t=0){const n=Ze(),r=n.getState().internal.subscribe,o=Ve(e);return Q(()=>r(o,t,n),[t,r,n]),null}const Fe=new WeakMap,en=e=>{var t;return typeof e=="function"&&(e==null||(t=e.prototype)==null?void 0:t.constructor)===e};function Je(e,t){return function(n,...r){let o;return en(n)?(o=Fe.get(n),o||(o=new n,Fe.set(n,o))):o=n,e&&e(o),Promise.all(r.map(s=>new Promise((u,l)=>o.load(s,i=>{F(i==null?void 0:i.scene)&&Object.assign(i,Ut(i.scene)),u(i)},t,i=>l(new Error(`Could not load ${s}: ${i==null?void 0:i.message}`))))))}}function Ke(e,t,n,r){const o=Array.isArray(t)?t:[t],s=Ft(Je(n,r),[e,...o],{equal:R.equ});return Array.isArray(t)?s:s[0]}Ke.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return Lt(Je(n),[e,...r])};Ke.clear=function(e,t){const n=Array.isArray(t)?t:[t];return Dt([e,...n])};function tn(e){const t=_t(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:b.version}),t}const Qe=0,Z={},nn=/^three(?=[A-Z])/,ue=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let rn=0;const on=e=>typeof e=="function";function sn(e){if(on(e)){const t=`${rn++}`;return Z[t]=e,t}else Object.assign(Z,e)}function et(e,t){const n=ue(e),r=Z[n];if(e!=="primitive"&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(e==="primitive"&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(t.args!==void 0&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function an(e,t,n){var r;return e=ue(e)in Z?e:e.replace(nn,""),et(e,t),e==="primitive"&&(r=t.object)!=null&&r.__r3f&&delete t.object.__r3f,ae(t.object,n,e,t)}function cn(e){if(!e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?le(e.parent,e):F(e.object)&&(e.object.visible=!1),e.isHidden=!0,$(e)}}function tt(e){if(e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?ce(e.parent,e):F(e.object)&&e.props.visible!==!1&&(e.object.visible=!0),e.isHidden=!1,$(e)}}function xe(e,t,n){const r=t.root.getState();if(!(!e.parent&&e.object!==r.scene)){if(!t.object){var o,s;const u=Z[ue(t.type)];t.object=(o=t.props.object)!=null?o:new u(...(s=t.props.args)!=null?s:[]),t.object.__r3f=t}if(B(t.object,t.props),t.props.attach)ce(e,t);else if(F(t.object)&&F(e.object)){const u=e.object.children.indexOf(n==null?void 0:n.object);if(n&&u!==-1){const l=e.object.children.indexOf(t.object);if(l!==-1){e.object.children.splice(l,1);const i=l<u?u-1:u;e.object.children.splice(i,0,t.object)}else t.object.parent=e.object,e.object.children.splice(u,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const u of t.children)xe(t,u);$(t)}}function ve(e,t){t&&(t.parent=e,e.children.push(t),xe(e,t))}function Le(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);r!==-1?e.children.splice(r,0,t):e.children.push(t),xe(e,t,n)}function nt(e){if(typeof e.dispose=="function"){const t=()=>{try{e.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT!="undefined"?t():Ie.unstable_scheduleCallback(Ie.unstable_IdlePriority,t)}}function Ce(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);r!==-1&&e.children.splice(r,1),t.props.attach?le(e,t):F(t.object)&&F(e.object)&&(e.object.remove(t.object),Jt(qe(t),t.object));const o=t.props.dispose!==null&&n!==!1;for(let s=t.children.length-1;s>=0;s--){const u=t.children[s];Ce(t,u,o)}t.children.length=0,delete t.object.__r3f,o&&t.type!=="primitive"&&t.object.type!=="Scene"&&nt(t.object),n===void 0&&$(t)}function ln(e,t){for(const n of[e,e.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const r=n.ref(t);typeof r=="function"&&(n.refCleanup=r)}else n.ref&&(n.ref.current=t)}const se=[];function fn(){for(const[n]of se){const r=n.parent;if(r){n.props.attach?le(r,n):F(n.object)&&F(r.object)&&r.object.remove(n.object);for(const o of n.children)o.props.attach?le(n,o):F(o.object)&&F(n.object)&&n.object.remove(o.object)}n.isHidden&&tt(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&nt(n.object)}for(const[n,r,o]of se){n.props=r;const s=n.parent;if(s){var e,t;const u=Z[ue(n.type)];n.object=(e=n.props.object)!=null?e:new u(...(t=n.props.args)!=null?t:[]),n.object.__r3f=n,ln(o,n.object),B(n.object,n.props),n.props.attach?ce(s,n):F(n.object)&&F(s.object)&&s.object.add(n.object);for(const l of n.children)l.props.attach?ce(n,l):F(l.object)&&F(n.object)&&n.object.add(l.object);$(n)}}se.length=0}const me=()=>{},De={};let re=Qe;const un=0,pn=4,Ee=tn({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:an,removeChild:Ce,appendChild:ve,appendInitialChild:ve,insertBefore:Le,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||ve(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Ce(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;!t||!n||!r||Le(r,t,n)},getRootHostContext:()=>De,getChildHostContext:()=>De,commitUpdate(e,t,n,r,o){var s,u,l;et(t,r);let i=!1;if((e.type==="primitive"&&n.object!==r.object||((s=r.args)==null?void 0:s.length)!==((u=n.args)==null?void 0:u.length)||(l=r.args)!=null&&l.some((a,f)=>{var v;return a!==((v=n.args)==null?void 0:v[f])}))&&(i=!0),i)se.push([e,{...r},o]);else{const a=Wt(e,r);Object.keys(a).length&&(Object.assign(e.props,a),B(e.object,a))}(o.sibling===null||(o.flags&pn)===un)&&fn()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>e==null?void 0:e.object,prepareForCommit:()=>null,preparePortalMount:e=>ae(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:cn,unhideInstance:tt,createTextInstance:me,hideTextInstance:me,unhideTextInstance:me,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:b.createContext(null),setCurrentUpdatePriority(e){re=e},getCurrentUpdatePriority(){return re},resolveUpdatePriority(){var e;if(re!==Qe)return re;switch(typeof window!="undefined"&&((e=window.event)==null?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ie.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ie.ContinuousEventPriority;default:return ie.DefaultEventPriority}},resetFormInstance(){}}),X=new Map,W={objects:"shallow",strict:!1};function dn(e,t){if(!t&&typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:r,top:o,left:s}=e.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:s}}else if(!t&&typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...t}}function vn(e){const t=X.get(e),n=t==null?void 0:t.fiber,r=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,s=r||Qt(Me,ze),u=n||Ee.createContainer(s,ie.ConcurrentRoot,null,!1,null,"",o,o,o,null);t||X.set(e,{fiber:u,store:s});let l,i,d=!1,a=null;return{async configure(f={}){let v;a=new Promise(P=>v=P);let{gl:h,size:S,scene:M,events:y,onCreated:p,shadows:c=!1,linear:j=!1,flat:E=!1,legacy:g=!1,orthographic:m=!1,frameloop:T="always",dpr:I=[1,2],performance:C,raycaster:x,camera:O,onPointerMissed:q}=f,w=s.getState(),k=w.gl;if(!w.gl){const P={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},_=typeof h=="function"?await h(P):h;Ae(_)?k=_:k=new it({...P,...h}),w.set({gl:k})}let H=w.raycaster;H||w.set({raycaster:H=new st});const{params:ee,...U}=x||{};if(R.equ(U,H,W)||B(H,{...U}),R.equ(ee,H.params,W)||B(H,{params:{...H.params,...ee}}),!w.camera||w.camera===i&&!R.equ(i,O,W)){i=O;const P=O==null?void 0:O.isCamera,_=P?O:m?new at(0,0,0,0,.1,1e3):new ct(75,0,.1,1e3);P||(_.position.z=5,O&&(B(_,O),_.manual||("aspect"in O||"left"in O||"right"in O||"bottom"in O||"top"in O)&&(_.manual=!0,_.updateProjectionMatrix())),!w.camera&&!(O!=null&&O.rotation)&&_.lookAt(0,0,0)),w.set({camera:_}),H.camera=_}if(!w.scene){let P;M!=null&&M.isScene?(P=M,ae(P,s,"",{})):(P=new lt,ae(P,s,"",{}),M&&B(P,M)),w.set({scene:P})}y&&!w.events.handlers&&w.set({events:y(s)});const V=dn(e,S);if(R.equ(V,w.size,W)||w.setSize(V.width,V.height,V.top,V.left),I&&w.viewport.dpr!==Xe(I)&&w.setDpr(I),w.frameloop!==T&&w.setFrameloop(T),w.onPointerMissed||w.set({onPointerMissed:q}),C&&!R.equ(C,w.performance,W)&&w.set(P=>({performance:{...P.performance,...C}})),!w.xr){var N;const P=(A,pe)=>{const Re=s.getState();Re.frameloop!=="never"&&ze(A,!0,Re,pe)},_=()=>{const A=s.getState();A.gl.xr.enabled=A.gl.xr.isPresenting,A.gl.xr.setAnimationLoop(A.gl.xr.isPresenting?P:null),A.gl.xr.isPresenting||Me(A)},z={connect(){const A=s.getState().gl;A.xr.addEventListener("sessionstart",_),A.xr.addEventListener("sessionend",_)},disconnect(){const A=s.getState().gl;A.xr.removeEventListener("sessionstart",_),A.xr.removeEventListener("sessionend",_)}};typeof((N=k.xr)==null?void 0:N.addEventListener)=="function"&&z.connect(),w.set({xr:z})}if(k.shadowMap){const P=k.shadowMap.enabled,_=k.shadowMap.type;if(k.shadowMap.enabled=!!c,R.boo(c))k.shadowMap.type=de;else if(R.str(c)){var te;const z={basic:pt,percentage:ut,soft:de,variance:ft};k.shadowMap.type=(te=z[c])!=null?te:de}else R.obj(c)&&Object.assign(k.shadowMap,c);(P!==k.shadowMap.enabled||_!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}return wt.enabled=!g,d||(k.outputColorSpace=j?dt:Ne,k.toneMapping=E?vt:mt),w.legacy!==g&&w.set(()=>({legacy:g})),w.linear!==j&&w.set(()=>({linear:j})),w.flat!==E&&w.set(()=>({flat:E})),h&&!R.fun(h)&&!Ae(h)&&!R.equ(h,k,W)&&B(k,h),l=p,d=!0,v(),this},render(f){return!d&&!a&&this.configure(),a.then(()=>{Ee.updateContainer(D.jsx(mn,{store:s,children:f,onCreated:l,rootElement:e}),u,null,()=>{})}),s},unmount(){rt(e)}}}function mn({store:e,children:t,onCreated:n,rootElement:r}){return Q(()=>{const o=e.getState();o.set(s=>({internal:{...s.internal,active:!0}})),n&&n(o),e.getState().events.connected||o.events.connect==null||o.events.connect(r)},[]),D.jsx(Ye.Provider,{value:e,children:t})}function rt(e,t){const n=X.get(e),r=n==null?void 0:n.fiber;if(r){const o=n==null?void 0:n.store.getState();o&&(o.internal.active=!1),Ee.updateContainer(null,r,null,()=>{o&&setTimeout(()=>{try{var s,u,l,i;o.events.disconnect==null||o.events.disconnect(),(s=o.gl)==null||(u=s.renderLists)==null||u.dispose==null||u.dispose(),(l=o.gl)==null||l.forceContextLoss==null||l.forceContextLoss(),(i=o.gl)!=null&&i.xr&&o.xr.disconnect(),Vt(o.scene),X.delete(e)}catch{}},500)})}}const hn=new Set,gn=new Set,bn=new Set;function he(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function J(e,t){switch(e){case"before":return he(hn,t);case"after":return he(gn,t);case"tail":return he(bn,t)}}let ge,be;function Pe(e,t,n){let r=t.clock.getDelta();t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),ge=t.internal.subscribers;for(let o=0;o<ge.length;o++)be=ge[o],be.ref.current(be.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}let fe=!1,Se=!1,ye,He,Y;function ot(e){He=requestAnimationFrame(ot),fe=!0,ye=0,J("before",e),Se=!0;for(const n of X.values()){var t;Y=n.store.getState(),Y.internal.active&&(Y.frameloop==="always"||Y.internal.frames>0)&&!((t=Y.gl.xr)!=null&&t.isPresenting)&&(ye+=Pe(e,Y))}if(Se=!1,J("after",e),ye===0)return J("tail",e),fe=!1,cancelAnimationFrame(He)}function Me(e,t=1){var n;if(!e)return X.forEach(r=>Me(r.store.getState(),t));(n=e.gl.xr)!=null&&n.isPresenting||!e.internal.active||e.frameloop==="never"||(t>1?e.internal.frames=Math.min(60,e.internal.frames+t):Se?e.internal.frames=2:e.internal.frames=1,fe||(fe=!0,requestAnimationFrame(ot)))}function ze(e,t=!0,n,r){if(t&&J("before",e),n)Pe(e,n,r);else for(const o of X.values())Pe(e,o.store.getState());t&&J("after",e)}const je={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function yn(e){const{handlePointer:t}=Kt(e);return{priority:1,enabled:!0,compute(n,r,o){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(je).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:o}=e.getState();(n=o.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(o.lastEvent.current)},connect:n=>{const{set:r,events:o}=e.getState();if(o.disconnect==null||o.disconnect(),r(s=>({events:{...s.events,connected:n}})),o.handlers)for(const s in o.handlers){const u=o.handlers[s],[l,i]=je[s];n.addEventListener(l,u,{passive:i})}},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){if(r.handlers)for(const o in r.handlers){const s=r.handlers[o],[u]=je[o];r.connected.removeEventListener(u,s)}n(o=>({events:{...o.events,connected:void 0}}))}}}}function jn({ref:e,children:t,fallback:n,resize:r,style:o,gl:s,events:u=yn,eventSource:l,eventPrefix:i,shadows:d,linear:a,flat:f,legacy:v,orthographic:h,frameloop:S,dpr:M,performance:y,raycaster:p,camera:c,scene:j,onPointerMissed:E,onCreated:g,...m}){b.useMemo(()=>sn(Ct),[]);const T=Nt(),[I,C]=xt({scroll:!0,debounce:{scroll:50,resize:0},...r}),x=b.useRef(null),O=b.useRef(null);b.useImperativeHandle(e,()=>x.current);const q=Ve(E),[w,k]=b.useState(!1),[H,ee]=b.useState(!1);if(w)throw w;if(H)throw H;const U=b.useRef(null);Q(()=>{const N=x.current;if(C.width>0&&C.height>0&&N){U.current||(U.current=vn(N));async function te(){await U.current.configure({gl:s,scene:j,events:u,shadows:d,linear:a,flat:f,legacy:v,orthographic:h,frameloop:S,dpr:M,performance:y,raycaster:p,camera:c,size:C,onPointerMissed:(...P)=>q.current==null?void 0:q.current(...P),onCreated:P=>{P.events.connect==null||P.events.connect(l?Ht(l)?l.current:l:O.current),i&&P.setEvents({compute:(_,z)=>{const A=_[i+"X"],pe=_[i+"Y"];z.pointer.set(A/z.size.width*2-1,-(pe/z.size.height)*2+1),z.raycaster.setFromCamera(z.pointer,z.camera)}}),g==null||g(P)}}),U.current.render(D.jsx(T,{children:D.jsx(qt,{set:ee,children:D.jsx(b.Suspense,{fallback:D.jsx(Bt,{set:k}),children:t!=null?t:null})})}))}te()}}),b.useEffect(()=>{const N=x.current;if(N)return()=>rt(N)},[]);const V=l?"none":"auto";return D.jsx("div",{ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:V,...o},...m,children:D.jsx("div",{ref:I,style:{width:"100%",height:"100%"},children:D.jsx("canvas",{ref:x,style:{display:"block"},children:n})})})}function Fn(e){return D.jsx(It,{children:D.jsx(jn,{...e})})}function wn(e,t,n){const r=L(v=>v.size),o=L(v=>v.viewport),s=typeof e=="number"?e:r.width*o.dpr,u=r.height*o.dpr,l=(typeof e=="number"?n:e)||{},{samples:i=0,depth:d,...a}=l,f=b.useMemo(()=>{const v=new Et(s,u,{minFilter:Te,magFilter:Te,type:Pt,...a});return d&&(v.depthTexture=new St(s,u,Mt)),v.samples=i,v},[]);return b.useLayoutEffect(()=>{f.setSize(s,u),i&&(f.samples=i)},[i,f,s,u]),b.useEffect(()=>()=>f.dispose(),[]),f}const Cn=e=>typeof e=="function",Ln=b.forwardRef(({envMap:e,resolution:t=256,frames:n=1/0,makeDefault:r,children:o,...s},u)=>{const l=L(({set:y})=>y),i=L(({camera:y})=>y),d=L(({size:y})=>y),a=b.useRef(null);b.useImperativeHandle(u,()=>a.current,[]);const f=b.useRef(null),v=wn(t);b.useLayoutEffect(()=>{s.manual||(a.current.aspect=d.width/d.height)},[d,s]),b.useLayoutEffect(()=>{a.current.updateProjectionMatrix()});let h=0,S=null;const M=Cn(o);return $e(y=>{M&&(n===1/0||h<n)&&(f.current.visible=!1,y.gl.setRenderTarget(v),S=y.scene.background,e&&(y.scene.background=e),y.gl.render(y.scene,a.current),y.scene.background=S,y.gl.setRenderTarget(null),f.current.visible=!0,h++)}),b.useLayoutEffect(()=>{if(r){const y=i;return l(()=>({camera:a.current})),()=>l(()=>({camera:y}))}},[a,r,l]),b.createElement(b.Fragment,null,b.createElement("perspectiveCamera",Be({ref:a},s),!M&&o),b.createElement("group",{ref:f},M&&o(v.texture)))}),Dn=b.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:o=!0,keyEvents:s=!1,onChange:u,onStart:l,onEnd:i,...d},a)=>{const f=L(m=>m.invalidate),v=L(m=>m.camera),h=L(m=>m.gl),S=L(m=>m.events),M=L(m=>m.setEvents),y=L(m=>m.set),p=L(m=>m.get),c=L(m=>m.performance),j=t||v,E=r||S.connected||h.domElement,g=b.useMemo(()=>new kt(j),[j]);return $e(()=>{g.enabled&&g.update()},-1),b.useEffect(()=>(s&&g.connect(s===!0?E:s),g.connect(E),()=>void g.dispose()),[s,E,n,g,f]),b.useEffect(()=>{const m=C=>{f(),n&&c.regress(),u&&u(C)},T=C=>{l&&l(C)},I=C=>{i&&i(C)};return g.addEventListener("change",m),g.addEventListener("start",T),g.addEventListener("end",I),()=>{g.removeEventListener("start",T),g.removeEventListener("end",I),g.removeEventListener("change",m)}},[u,l,i,g,f,M]),b.useEffect(()=>{if(e){const m=p().controls;return y({controls:g}),()=>y({controls:m})}},[e,g]),b.createElement("primitive",Be({ref:a,object:g,enableDamping:o},d))});export{Fn as C,Dn as O,Ln as P,Ke as u};
